<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>WebRTC에서 Agora로: 왜 Agora SDK를 선택했을까? | 블로그</title>
<meta name=keywords content><meta name=description content="실시간 영상 통신을 안정적으로 서비스하는 것은 생각보다 복잡했습니다. 특히 네트워크 환경이 불안정한 해외 사용자를 대상으로 할 경우, 그 어려움은 더 커집니다.
이번 글에서는 기존 WebRTC 기반 1:1 연결 구조에서 Agora RTC SDK로 전환하게 된 계기와, 그 과정에서 네트워크 품질 측정과 Agora 구조를 소개하고자 합니다.

왜 Agora SDK 였을까?
기존 WebRTC 기반 연결 구조는 다음과 같은 문제점을 가지고 있었습니다.

STUN/TURN 서버 인프라 구축 비용 증가
해외 네트워크 접속 불안정
연결 전 품질 측정의 어려움

👉 이전 글: 해외 사용자 대상 WebRTC 연결, 어떻게 진단했을까?"><meta name=author content><link rel=canonical href=https://leeyeonseong.github.io/tech-blog/articles/react-agorasdk/><link crossorigin=anonymous href=/tech-blog/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF+13Dyqob6ASlTrTye8=" rel="preload stylesheet" as=style><link rel=icon href=https://leeyeonseong.github.io/tech-blog/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://leeyeonseong.github.io/tech-blog/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://leeyeonseong.github.io/tech-blog/favicon-32x32.png><link rel=apple-touch-icon href=https://leeyeonseong.github.io/tech-blog/apple-touch-icon.png><link rel=mask-icon href=https://leeyeonseong.github.io/tech-blog/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://leeyeonseong.github.io/tech-blog/articles/react-agorasdk/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://leeyeonseong.github.io/tech-blog/articles/react-agorasdk/"><meta property="og:site_name" content="블로그"><meta property="og:title" content="WebRTC에서 Agora로: 왜 Agora SDK를 선택했을까?"><meta property="og:description" content="실시간 영상 통신을 안정적으로 서비스하는 것은 생각보다 복잡했습니다. 특히 네트워크 환경이 불안정한 해외 사용자를 대상으로 할 경우, 그 어려움은 더 커집니다.
이번 글에서는 기존 WebRTC 기반 1:1 연결 구조에서 Agora RTC SDK로 전환하게 된 계기와, 그 과정에서 네트워크 품질 측정과 Agora 구조를 소개하고자 합니다.
왜 Agora SDK 였을까? 기존 WebRTC 기반 연결 구조는 다음과 같은 문제점을 가지고 있었습니다.
STUN/TURN 서버 인프라 구축 비용 증가 해외 네트워크 접속 불안정 연결 전 품질 측정의 어려움 👉 이전 글: 해외 사용자 대상 WebRTC 연결, 어떻게 진단했을까?"><meta property="og:locale" content="ko"><meta property="og:type" content="article"><meta property="article:section" content="articles"><meta property="article:published_time" content="2024-02-26T00:00:00+00:00"><meta property="article:modified_time" content="2024-02-26T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="WebRTC에서 Agora로: 왜 Agora SDK를 선택했을까?"><meta name=twitter:description content="실시간 영상 통신을 안정적으로 서비스하는 것은 생각보다 복잡했습니다. 특히 네트워크 환경이 불안정한 해외 사용자를 대상으로 할 경우, 그 어려움은 더 커집니다.
이번 글에서는 기존 WebRTC 기반 1:1 연결 구조에서 Agora RTC SDK로 전환하게 된 계기와, 그 과정에서 네트워크 품질 측정과 Agora 구조를 소개하고자 합니다.

왜 Agora SDK 였을까?
기존 WebRTC 기반 연결 구조는 다음과 같은 문제점을 가지고 있었습니다.

STUN/TURN 서버 인프라 구축 비용 증가
해외 네트워크 접속 불안정
연결 전 품질 측정의 어려움

👉 이전 글: 해외 사용자 대상 WebRTC 연결, 어떻게 진단했을까?"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Articles","item":"https://leeyeonseong.github.io/tech-blog/articles/"},{"@type":"ListItem","position":2,"name":"WebRTC에서 Agora로: 왜 Agora SDK를 선택했을까?","item":"https://leeyeonseong.github.io/tech-blog/articles/react-agorasdk/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"WebRTC에서 Agora로: 왜 Agora SDK를 선택했을까?","name":"WebRTC에서 Agora로: 왜 Agora SDK를 선택했을까?","description":"실시간 영상 통신을 안정적으로 서비스하는 것은 생각보다 복잡했습니다. 특히 네트워크 환경이 불안정한 해외 사용자를 대상으로 할 경우, 그 어려움은 더 커집니다.\n이번 글에서는 기존 WebRTC 기반 1:1 연결 구조에서 Agora RTC SDK로 전환하게 된 계기와, 그 과정에서 네트워크 품질 측정과 Agora 구조를 소개하고자 합니다.\n왜 Agora SDK 였을까? 기존 WebRTC 기반 연결 구조는 다음과 같은 문제점을 가지고 있었습니다.\nSTUN/TURN 서버 인프라 구축 비용 증가 해외 네트워크 접속 불안정 연결 전 품질 측정의 어려움 👉 이전 글: 해외 사용자 대상 WebRTC 연결, 어떻게 진단했을까?\n","keywords":[],"articleBody":"실시간 영상 통신을 안정적으로 서비스하는 것은 생각보다 복잡했습니다. 특히 네트워크 환경이 불안정한 해외 사용자를 대상으로 할 경우, 그 어려움은 더 커집니다.\n이번 글에서는 기존 WebRTC 기반 1:1 연결 구조에서 Agora RTC SDK로 전환하게 된 계기와, 그 과정에서 네트워크 품질 측정과 Agora 구조를 소개하고자 합니다.\n왜 Agora SDK 였을까? 기존 WebRTC 기반 연결 구조는 다음과 같은 문제점을 가지고 있었습니다.\nSTUN/TURN 서버 인프라 구축 비용 증가 해외 네트워크 접속 불안정 연결 전 품질 측정의 어려움 👉 이전 글: 해외 사용자 대상 WebRTC 연결, 어떻게 진단했을까?\n초기에는 Sendbird 또한 후보군에 포함되어 있었습니다.\n당시 팀원들과의 기술 검토 회의에서는 다음과 같은 논의가 오갔습니다:\nSendbird는 채팅과 푸시 알림 중심으로 강점을 갖고 있고, 반면 Agora는 영상 연결 자체에 특화된 SDK이며, 특히 가상 배경 처리 / 화면 공유 / 네트워크 품질 측정 API 등 영상 통신의 핵심 기능에 집중된 구조 실제로 Agora의 VirtualBackgroundExtension은 우리가 요구한 가상 배경 적용 기능을 공식 지원하고 있었고, 다자간 영상 통화 안정성도 검증된 상태였습니다 이러한 점에서 Agora가 우리 프로젝트의 핵심 요구사항에 더 적합하다고 판단하여 최종적으로 선택하게 되었습니다.\n팀원들과 생각한 AgoraSDK의 장점 Agora는 단순한 P2P 연결을 넘어서 다음과 같은 강점을 제공합니다.\nCloud 기반 인프라: TURN 서버 증설 없이 1:N 연결 가능 적응형 스트리밍: 네트워크 품질에 따라 자동 화질 조정 연결 품질 측정 API 제공: network-quality 이벤트를 통해 실시간 네트워크 상태 모니터링 화면 공유, 가상 배경 등 기능 내장 자체 어드민 페이지 제공으로 실시간 이슈 대응 Agora 연결 흐름 요약 Agora SDK의 기본 연결 흐름은 다음과 같습니다.\n오디오 및 비디오 트랙 생성 채널 및 토큰을 기반으로 조인 트랙 publish 원격 사용자 subscribe // 1. 트랙 생성 const [micTrack, camTrack] = await AgoraRTC.createMicrophoneAndCameraTracks(); // 2. 채널 조인 await agoraClient.join(APP_ID, channel, token, uid); // 3. publish await agoraClient.publish([micTrack, camTrack]); // 4. remote user subscribe agoraClient.on(\"user-published\", async (user, mediaType) =\u003e { await agoraClient.subscribe(user, mediaType); }); 실제 구현에서는 enableDualStream, volume-indicator, network-quality 등 이벤트를 함께 활용해 사용자 경험을 개선하고 있습니다.\n네트워크 품질 테스트 hook 구성 기존 WebRTC 기반 서비스에서는 영상 연결 전 품질 테스트 기능이 없었습니다. 이로 인해 연결 직후에 끊김이나 오류가 발생하고, 사용자 불만이 증가하는 문제가 있었습니다.\n이를 해결하기 위해 Agora SDK를 기반으로 다음과 같은 네트워크 품질 진단 전용 훅을 구현했습니다.\n네트워크 품질을 실시간 확인하고, 품질이 나쁠 경우 사용자에게 경고 uplink/downlink 모두 확인 5초 내로 진단 완료 → 자동 연결 종료 구성 요소 설명 uplinkClient 로컬 트랙 publish 전용 클라이언트 downlinkClient 원격 사용자 subscribe 전용 클라이언트 microphoneTrack, cameraTrack 테스트용 로컬 트랙 handleConnection network-quality 이벤트 핸들러 closeConnection 5초 후 자동 종료 처리 useNetworkCheck.ts const useNetworkCheck = () =\u003e { ... // 생략 const uplinkClient = AgoraRTC.createClient({ mode: \"rtc\", codec: \"vp8\" }); const downlinkClient = AgoraRTC.createClient({ mode: \"rtc\", codec: \"vp8\" }); // 트랙 생성 및 채널 조인 const [mic, cam] = await AgoraRTC.createMicrophoneAndCameraTracks(); await uplinkClient.join(APP_ID, channelName, token, \"uplink\"); await downlinkClient.join(APP_ID, channelName, token, \"downlink\"); // 네트워크 품질 체크 핸들러 uplinkClient.on(\"network-quality\", handleConnection); downlinkClient.on(\"network-quality\", handleConnection); ... // 생략 const handleConnection = ({ uplinkNetworkQuality, downlinkNetworkQuality, }) =\u003e { if (uplinkNetworkQuality \u003e 3 || downlinkNetworkQuality \u003e 3) { connectionRef.current = \"fail\"; } else { connectionRef.current = \"success\"; } }; return {...} }; useNetworkCheck.ts hook을 도입함으로써, 다음과 같은 효과를 얻었습니다:\n영상 통화 단계에서 사용자에게 실간 문제를 안내할 수 있게 됨 문제 발생 시 연결 중단 후 안내 메시지 출력 고객 신뢰도 및 진료 품질 모두 개선 Agora Admin을 통한 품질 분석 Agora의 Admin Console에서는 실제 통화 후 다음과 같은 품질 데이터를 시각적으로 분석할 수 있습니다.\n타임라인에서는 각종 이벤트들을 시간대별로 확인할 수 있습니다.\nSender/Receiver별, Audio/Video별 품질 추이도 확인할 수 있습니다.\nㄴ 에러가 발생하면 빨간 경고선, bitrate 하락, packet loss 등의 지표가 시각적으로 드러납니다.\n마무리하며 WebRTC에서 Agora로 전환하며 WebRTC는 유연하지만, 다자간 연결과 글로벌 품질 보장을 위해서는 인프라 확장이 필수였고, 이는 유지보수 부담과 불확실성을 동반했습니다.\nAgora는 다음과 같은 점에서 큰 도움이 되었습니다:\nCloud 인프라 기반의 안정적인 연결 영상 중심 기능(가상 배경, 화면 공유, 네트워크 측정) 지원 품질 테스트, 트랙 관리, 화질 조정 등 통합 관리 구조 또한 팀 회의를 통해 기술 비교 → 요구사항 정의 → 직접 PoC 테스트 과정을 거치며, 기술 선택에 대한 명확한 기준과 확신을 갖게 된 것도 큰 의미가 있었습니다.\n","wordCount":"642","inLanguage":"en","datePublished":"2024-02-26T00:00:00Z","dateModified":"2024-02-26T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://leeyeonseong.github.io/tech-blog/articles/react-agorasdk/"},"publisher":{"@type":"Organization","name":"블로그","logo":{"@type":"ImageObject","url":"https://leeyeonseong.github.io/tech-blog/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://leeyeonseong.github.io/tech-blog/ accesskey=h title="블로그 (Alt + H)">블로그</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://leeyeonseong.github.io/tech-blog/articles/ title=Articles><span>Articles</span></a></li><li><a href=https://leeyeonseong.github.io/tech-blog/about/ title="About me"><span>About me</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">WebRTC에서 Agora로: 왜 Agora SDK를 선택했을까?</h1><div class=post-meta><span title='2024-02-26 00:00:00 +0000 UTC'>February 26, 2024</span></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%ec%99%9c-agora-sdk-%ec%98%80%ec%9d%84%ea%b9%8c aria-label="왜 Agora SDK 였을까?">왜 Agora SDK 였을까?</a></li><li><a href=#%ed%8c%80%ec%9b%90%eb%93%a4%ea%b3%bc-%ec%83%9d%ea%b0%81%ed%95%9c-agorasdk%ec%9d%98-%ec%9e%a5%ec%a0%90 aria-label="팀원들과 생각한 AgoraSDK의 장점">팀원들과 생각한 AgoraSDK의 장점</a></li><li><a href=#agora-%ec%97%b0%ea%b2%b0-%ed%9d%90%eb%a6%84-%ec%9a%94%ec%95%bd aria-label="Agora 연결 흐름 요약">Agora 연결 흐름 요약</a></li><li><a href=#%eb%84%a4%ed%8a%b8%ec%9b%8c%ed%81%ac-%ed%92%88%ec%a7%88-%ed%85%8c%ec%8a%a4%ed%8a%b8-hook-%ea%b5%ac%ec%84%b1 aria-label="네트워크 품질 테스트 hook 구성">네트워크 품질 테스트 hook 구성</a><ul><li><a href=#usenetworkcheckts aria-label=useNetworkCheck.ts>useNetworkCheck.ts</a></li></ul></li><li><a href=#agora-admin%ec%9d%84-%ed%86%b5%ed%95%9c-%ed%92%88%ec%a7%88-%eb%b6%84%ec%84%9d aria-label="Agora Admin을 통한 품질 분석">Agora Admin을 통한 품질 분석</a></li><li><a href=#%eb%a7%88%eb%ac%b4%eb%a6%ac%ed%95%98%eb%a9%b0 aria-label=마무리하며>마무리하며</a></li></ul></div></details></div><div class=post-content><p>실시간 영상 통신을 안정적으로 서비스하는 것은 생각보다 복잡했습니다. 특히 네트워크 환경이 불안정한 해외 사용자를 대상으로 할 경우, 그 어려움은 더 커집니다.</p><p>이번 글에서는 기존 WebRTC 기반 1:1 연결 구조에서 Agora RTC SDK로 전환하게 된 계기와, 그 과정에서 네트워크 품질 측정과 Agora 구조를 소개하고자 합니다.</p><hr><h2 id=왜-agora-sdk-였을까>왜 Agora SDK 였을까?<a hidden class=anchor aria-hidden=true href=#왜-agora-sdk-였을까>#</a></h2><p>기존 WebRTC 기반 연결 구조는 다음과 같은 문제점을 가지고 있었습니다.</p><ul><li><strong>STUN/TURN 서버 인프라 구축 비용 증가</strong></li><li><strong>해외 네트워크 접속 불안정</strong></li><li><strong>연결 전 품질 측정의 어려움</strong></li></ul><p>👉 <a href=/tech-blog/articles/socket-issue/>이전 글: 해외 사용자 대상 WebRTC 연결, 어떻게 진단했을까?</a></p><p>초기에는 <strong>Sendbird</strong> 또한 후보군에 포함되어 있었습니다.<br>당시 팀원들과의 기술 검토 회의에서는 다음과 같은 논의가 오갔습니다:</p><ul><li><strong>Sendbird</strong>는 <strong>채팅과 푸시 알림 중심</strong>으로 강점을 갖고 있고,</li><li>반면 <strong>Agora는 영상 연결 자체에 특화된 SDK</strong>이며, 특히 <strong>가상 배경 처리 / 화면 공유 / 네트워크 품질 측정 API</strong> 등 영상 통신의 핵심 기능에 집중된 구조</li><li>실제로 Agora의 <code>VirtualBackgroundExtension</code>은 우리가 요구한 <strong>가상 배경 적용</strong> 기능을 공식 지원하고 있었고, 다자간 영상 통화 안정성도 검증된 상태였습니다</li></ul><p>이러한 점에서 Agora가 우리 프로젝트의 <strong>핵심 요구사항</strong>에 더 적합하다고 판단하여 최종적으로 선택하게 되었습니다.</p><hr><h2 id=팀원들과-생각한-agorasdk의-장점>팀원들과 생각한 AgoraSDK의 장점<a hidden class=anchor aria-hidden=true href=#팀원들과-생각한-agorasdk의-장점>#</a></h2><p>Agora는 단순한 P2P 연결을 넘어서 다음과 같은 강점을 제공합니다.</p><ul><li><strong>Cloud 기반 인프라</strong>: TURN 서버 증설 없이 1:N 연결 가능</li><li><strong>적응형 스트리밍</strong>: 네트워크 품질에 따라 자동 화질 조정</li><li><strong>연결 품질 측정 API 제공</strong>: <code>network-quality</code> 이벤트를 통해 실시간 네트워크 상태 모니터링</li><li><strong>화면 공유, 가상 배경 등 기능 내장</strong></li><li><strong>자체 어드민 페이지 제공으로 실시간 이슈 대응</strong></li></ul><hr><h2 id=agora-연결-흐름-요약>Agora 연결 흐름 요약<a hidden class=anchor aria-hidden=true href=#agora-연결-흐름-요약>#</a></h2><p><a href=https://api-ref.agora.io/en/video-sdk/reactjs/2.x/index.html>Agora SDK</a>의 기본 연결 흐름은 다음과 같습니다.</p><ol><li><strong>오디오 및 비디오 트랙 생성</strong></li><li><strong>채널 및 토큰을 기반으로 조인</strong></li><li><strong>트랙 publish</strong></li><li><strong>원격 사용자 subscribe</strong></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#75715e>// 1. 트랙 생성
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> [<span style=color:#a6e22e>micTrack</span>, <span style=color:#a6e22e>camTrack</span>] <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>AgoraRTC</span>.<span style=color:#a6e22e>createMicrophoneAndCameraTracks</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 2. 채널 조인
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>await</span> <span style=color:#a6e22e>agoraClient</span>.<span style=color:#a6e22e>join</span>(<span style=color:#a6e22e>APP_ID</span>, <span style=color:#a6e22e>channel</span>, <span style=color:#a6e22e>token</span>, <span style=color:#a6e22e>uid</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 3. publish
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>await</span> <span style=color:#a6e22e>agoraClient</span>.<span style=color:#a6e22e>publish</span>([<span style=color:#a6e22e>micTrack</span>, <span style=color:#a6e22e>camTrack</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 4. remote user subscribe
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>agoraClient</span>.<span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#34;user-published&#34;</span>, <span style=color:#66d9ef>async</span> (<span style=color:#a6e22e>user</span>, <span style=color:#a6e22e>mediaType</span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>agoraClient</span>.<span style=color:#a6e22e>subscribe</span>(<span style=color:#a6e22e>user</span>, <span style=color:#a6e22e>mediaType</span>);
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><p>실제 구현에서는 enableDualStream, volume-indicator, network-quality 등 이벤트를 함께 활용해 사용자 경험을 개선하고 있습니다.</p><h2 id=네트워크-품질-테스트-hook-구성>네트워크 품질 테스트 hook 구성<a hidden class=anchor aria-hidden=true href=#네트워크-품질-테스트-hook-구성>#</a></h2><p>기존 WebRTC 기반 서비스에서는 영상 연결 전 품질 테스트 기능이 없었습니다. 이로 인해 연결 직후에 끊김이나 오류가 발생하고, 사용자 불만이 증가하는 문제가 있었습니다.</p><p>이를 해결하기 위해 Agora SDK를 기반으로 다음과 같은 네트워크 품질 진단 전용 훅을 구현했습니다.</p><ul><li>네트워크 품질을 실시간 확인하고, 품질이 나쁠 경우 사용자에게 경고</li><li>uplink/downlink 모두 확인</li><li>5초 내로 진단 완료 → 자동 연결 종료</li></ul><table><thead><tr><th>구성 요소</th><th>설명</th></tr></thead><tbody><tr><td><code>uplinkClient</code></td><td>로컬 트랙 publish 전용 클라이언트</td></tr><tr><td><code>downlinkClient</code></td><td>원격 사용자 subscribe 전용 클라이언트</td></tr><tr><td><code>microphoneTrack</code>, <code>cameraTrack</code></td><td>테스트용 로컬 트랙</td></tr><tr><td><code>handleConnection</code></td><td><code>network-quality</code> 이벤트 핸들러</td></tr><tr><td><code>closeConnection</code></td><td>5초 후 자동 종료 처리</td></tr></tbody></table><h3 id=usenetworkcheckts><code>useNetworkCheck.ts</code><a hidden class=anchor aria-hidden=true href=#usenetworkcheckts>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-tsx data-lang=tsx><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>useNetworkCheck</span> <span style=color:#f92672>=</span> () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  ... <span style=color:#75715e>// 생략
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>uplinkClient</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>AgoraRTC</span>.<span style=color:#a6e22e>createClient</span>({ <span style=color:#a6e22e>mode</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;rtc&#34;</span>, <span style=color:#a6e22e>codec</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;vp8&#34;</span> });
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>downlinkClient</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>AgoraRTC</span>.<span style=color:#a6e22e>createClient</span>({ <span style=color:#a6e22e>mode</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;rtc&#34;</span>, <span style=color:#a6e22e>codec</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;vp8&#34;</span> });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 트랙 생성 및 채널 조인
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>const</span> [<span style=color:#a6e22e>mic</span>, <span style=color:#a6e22e>cam</span>] <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>AgoraRTC</span>.<span style=color:#a6e22e>createMicrophoneAndCameraTracks</span>();
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>uplinkClient</span>.<span style=color:#a6e22e>join</span>(<span style=color:#a6e22e>APP_ID</span>, <span style=color:#a6e22e>channelName</span>, <span style=color:#a6e22e>token</span>, <span style=color:#e6db74>&#34;uplink&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>downlinkClient</span>.<span style=color:#a6e22e>join</span>(<span style=color:#a6e22e>APP_ID</span>, <span style=color:#a6e22e>channelName</span>, <span style=color:#a6e22e>token</span>, <span style=color:#e6db74>&#34;downlink&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 네트워크 품질 체크 핸들러
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>uplinkClient</span>.<span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#34;network-quality&#34;</span>, <span style=color:#a6e22e>handleConnection</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>downlinkClient</span>.<span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#34;network-quality&#34;</span>, <span style=color:#a6e22e>handleConnection</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  ... <span style=color:#75715e>// 생략
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>handleConnection</span> <span style=color:#f92672>=</span> ({
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>uplinkNetworkQuality</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>downlinkNetworkQuality</span>,
</span></span><span style=display:flex><span>  }) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>uplinkNetworkQuality</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>3</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>downlinkNetworkQuality</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>3</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>connectionRef</span>.<span style=color:#a6e22e>current</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;fail&#34;</span>;
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>connectionRef</span>.<span style=color:#a6e22e>current</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;success&#34;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> {...}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p><code>useNetworkCheck.ts</code> hook을 도입함으로써, 다음과 같은 효과를 얻었습니다:</p><ul><li>영상 통화 단계에서 사용자에게 실간 문제를 안내할 수 있게 됨</li><li>문제 발생 시 연결 중단 후 안내 메시지 출력</li><li>고객 신뢰도 및 진료 품질 모두 개선</li></ul><hr><h2 id=agora-admin을-통한-품질-분석>Agora Admin을 통한 품질 분석<a hidden class=anchor aria-hidden=true href=#agora-admin을-통한-품질-분석>#</a></h2><p>Agora의 Admin Console에서는 실제 통화 후 다음과 같은 품질 데이터를 시각적으로 분석할 수 있습니다.</p><ul><li><p>타임라인에서는 각종 이벤트들을 시간대별로 확인할 수 있습니다.</p></li><li><p>Sender/Receiver별, Audio/Video별 품질 추이도 확인할 수 있습니다.</p></li><li><p>ㄴ 에러가 발생하면 빨간 경고선, bitrate 하락, packet loss 등의 지표가 시각적으로 드러납니다.</p></li></ul><p align=center><img src=/tech-blog/assets/images/agora-network-ping.png alt="agora network" width=700></p><hr><h2 id=마무리하며>마무리하며<a hidden class=anchor aria-hidden=true href=#마무리하며>#</a></h2><p>WebRTC에서 Agora로 전환하며
WebRTC는 유연하지만, 다자간 연결과 글로벌 품질 보장을 위해서는 인프라 확장이 필수였고, 이는 유지보수 부담과 불확실성을 동반했습니다.</p><p>Agora는 다음과 같은 점에서 큰 도움이 되었습니다:</p><ul><li>Cloud 인프라 기반의 안정적인 연결</li><li>영상 중심 기능(가상 배경, 화면 공유, 네트워크 측정) 지원</li><li>품질 테스트, 트랙 관리, 화질 조정 등 통합 관리 구조</li></ul><p>또한 팀 회의를 통해 기술 비교 → 요구사항 정의 → 직접 PoC 테스트 과정을 거치며, 기술 선택에 대한 명확한 기준과 확신을 갖게 된 것도 큰 의미가 있었습니다.</p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://leeyeonseong.github.io/tech-blog/articles/react-virtualized/><span class=title>« Prev</span><br><span>react-virtualized로 대용량 리스트 렌더링 최적화하기</span>
</a><a class=next href=https://leeyeonseong.github.io/tech-blog/articles/react-native-codepush/><span class=title>Next »</span><br><span>React Native에 CodePush 도입기</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://leeyeonseong.github.io/tech-blog/>블로그</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>